// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.960
package pages

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

//go:generate templ generate
func AuthCallbackContent() templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<div class=\"max-w-2xl mx-auto text-center\"><div class=\"glass-card rounded-lg shadow-2xl p-8\"><div class=\"mb-6\"><div class=\"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500 mx-auto glow-effect\"></div></div><h2 class=\"text-2xl font-bold text-white mb-4\">Setting up your session...</h2><p id=\"auth-message\" class=\"text-gray-300 mb-6\">Please wait while we authenticate you...</p><div id=\"error-message\" class=\"hidden text-red-400 bg-red-900/50 border border-red-400/50 px-4 py-3 rounded mb-4\"></div><div id=\"success-message\" class=\"hidden text-green-400 bg-green-900/50 border border-green-400/50 px-4 py-3 rounded mb-4\"></div></div></div><script>\n\t\t// Function to get provider name from URL or code format\n\t\tfunction getProviderName() {\n\t\t\tvar urlParams = new URLSearchParams(window.location.search);\n\t\t\tvar code = urlParams.get('code');\n\t\t\t\n\t\t\tif (code) {\n\t\t\t\tif (code.startsWith('discord_')) {\n\t\t\t\t\treturn 'Discord';\n\t\t\t\t} else if (code.startsWith('gh_') || code.startsWith('github_')) {\n\t\t\t\t\treturn 'GitHub';\n\t\t\t\t} else if (code.startsWith('google_') || code.includes('.')) {\n\t\t\t\t\treturn 'Google';\n\t\t\t\t} else if (code.startsWith('ms_') || code.startsWith('microsoft_')) {\n\t\t\t\t\treturn 'Microsoft';\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// Fallback: check URL path\n\t\t\tvar path = window.location.pathname;\n\t\t\tif (path.includes('discord')) return 'Discord';\n\t\t\tif (path.includes('github')) return 'GitHub';\n\t\t\tif (path.includes('google')) return 'Google';\n\t\t\tif (path.includes('microsoft')) return 'Microsoft';\n\t\t\t\n\t\t\treturn 'your provider';\n\t\t}\n\t\t\n\t\t// Function to parse URL parameters (query string)\n\t\tfunction parseParameters() {\n\t\t\tvar search = window.location.search.substring(1); // Remove ?\n\t\t\tvar fragment = window.location.hash.substring(1); // Remove #\n\t\t\tvar params = {};\n\t\t\t\n\t\t\tconsole.log('üîç PARSE: Full URL:', window.location.href);\n\t\t\tconsole.log('üîç PARSE: Search params:', search);\n\t\t\tconsole.log('üîç PARSE: Hash fragment:', fragment);\n\t\t\t\n\t\t\t// Parse query parameters first (OAuth code comes here)\n\t\t\tif (search) {\n\t\t\t\tvar pairs = search.split('&');\n\t\t\t\tfor (var i = 0; i < pairs.length; i++) {\n\t\t\t\t\tvar pair = pairs[i].split('=');\n\t\t\t\t\tif (pair.length === 2) {\n\t\t\t\t\t\tparams[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// Also parse hash fragment (for backward compatibility)\n\t\t\tif (fragment) {\n\t\t\t\tvar hashPairs = fragment.split('&');\n\t\t\t\tfor (var j = 0; j < hashPairs.length; j++) {\n\t\t\t\t\tvar hashPair = hashPairs[j].split('=');\n\t\t\t\t\tif (hashPair.length === 2) {\n\t\t\t\t\t\tparams[decodeURIComponent(hashPair[0])] = decodeURIComponent(hashPair[1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tconsole.log('üîç PARSE: All parsed parameters:', params);\n\t\t\treturn params;\n\t\t}\n\n\t\t// Function to set session and redirect\n\t\tfunction setSessionAndRedirect() {\n\t\t\tconsole.log('üîê CALLBACK: === CALLBACK FUNCTION STARTED ===');\n\t\t\t\n\t\t\tvar params = parseParameters();\n\t\t\tconsole.log('üîê CALLBACK: Parsed parameters:', params);\n\t\t\t\n\t\t\t// Update message with provider name\n\t\t\tvar providerName = getProviderName();\n\t\t\tvar messageElement = document.getElementById('auth-message');\n\t\t\tmessageElement.textContent = 'Please wait while we authenticate you with ' + providerName + '.';\n\t\t\tconsole.log('üîê CALLBACK: Provider detected:', providerName);\n\t\t\t\n\t\t\t// Check for OAuth auth_code in URL (auth service sends auth_code, not code)\n\t\t\tvar code = params['auth_code'];\n\t\t\tconsole.log('üîê CALLBACK: Auth code from params:', code);\n\t\t\t\n\t\t\tif (!code) {\n\t\t\t\tconsole.error('üîê CALLBACK: No authorization code found in URL params');\n\t\t\t\tshowError('No authorization code found in URL. Please try logging in again.');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tconsole.log('üîê CALLBACK: Authorization code received, length:', code.length);\n\t\t\tconsole.log('üîê CALLBACK: Code preview:', code.substring(0, 20) + '...');\n\n\t\t\tconsole.log('üîê CALLBACK: === ABOUT TO MAKE FETCH CALL ===');\n\t\t\t\n\t\t\t// Exchange code for tokens via server endpoint\n\t\t\tfetch('/api/auth/exchange-code', {\n\t\t\t\tmethod: 'POST',\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\tauth_code: code\n\t\t\t\t})\n\t\t\t})\n\t\t\t.then(response => {\n\t\t\t\tconsole.log('üîê CALLBACK: === FETCH RESPONSE RECEIVED ===');\n\t\t\t\tconsole.log('üîê CALLBACK: Exchange code response status:', response.status);\n\t\t\t\tconsole.log('üîê CALLBACK: Response ok:', response.ok);\n\t\t\t\treturn response.json().then(data => {\n\t\t\t\t\tconsole.log('üîê CALLBACK: Exchange code response data:', data);\n\t\t\t\t\treturn { ok: response.ok, data: data };\n\t\t\t\t});\n\t\t\t})\n\t\t\t.then(result => {\n\t\t\t\tconsole.log('üîê CALLBACK: === PROCESSING FETCH RESULT ===');\n\t\t\t\tconsole.log('üîê CALLBACK: Result:', result);\n\t\t\t\tif (result.ok && result.data.success) {\n\t\t\t\t\tconsole.log('üîê CALLBACK: Successfully exchanged code for tokens');\n\t\t\t\t\tshowSuccess('Authentication successful! Redirecting to home...');\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\twindow.location.href = '/';\n\t\t\t\t\t}, 1500);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.error('üîê CALLBACK: Fetch failed or unsuccessful:', result);\n\t\t\t\t\tthrow new Error(result.data.error || 'Failed to exchange authorization code');\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tconsole.error('üîê CALLBACK: === FETCH ERROR ===');\n\t\t\t\tconsole.error('üîê CALLBACK: Error details:', error);\n\t\t\t\tconsole.error('üîê CALLBACK: Error message:', error.message);\n\t\t\t\tconsole.error('üîê CALLBACK: Error stack:', error.stack);\n\t\t\t\tshowError('Error: ' + error.message);\n\t\t\t});\n\t\t\t\t\n\t\t\tconsole.log('üîê CALLBACK: === FETCH CALL INITIATED (async) ===');\n\t\t}\n\n\t\tfunction showError(message) {\n\t\t\tvar errorDiv = document.getElementById('error-message');\n\t\t\terrorDiv.textContent = message;\n\t\t\terrorDiv.classList.remove('hidden');\n\t\t}\n\n\t\tfunction showSuccess(message) {\n\t\t\tvar successDiv = document.getElementById('success-message');\n\t\t\tsuccessDiv.textContent = message;\n\t\t\tsuccessDiv.classList.remove('hidden');\n\t\t}\n\n\t\t// Run when page loads\n\t\tsetSessionAndRedirect();\n\t</script>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

var _ = templruntime.GeneratedTemplate
